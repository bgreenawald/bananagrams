!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return m})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return h})),n.d(t,"m",(function(){return y})),n.d(t,"n",(function(){return v})),n.d(t,"k",(function(){return o})),n.d(t,"l",(function(){return l}));let r=[],o=!1;const a=document.querySelector(".menu"),l=!1;var i=function(e){e.preventDefault();var t=e.target.classList;t.contains("selected")?t.remove("selected"):t.add("selected")},c=function(e){e.target.style.opacity=.4,e.target.classList.contains("selected")||e.target.classList.add("selected"),e.target.style.cursor="grabbing",e.dataTransfer.dropEffect="copy",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text",e.target.dataset.tileId)},u=function(e){e.target.style.opacity=""},d=function(e){e.preventDefault(),e.target.classList.contains("selected")&&e.target.classList.remove("selected"),e.target.classList.contains("swap")?(a.setAttribute("active-tile-id",null),e.target.classList.remove("swap")):(a.setAttribute("active-tile-id",e.target.getAttribute("data-tile-id")),e.target.classList.add("swap"))},s=function(e){e.preventDefault(),0===e.target.children.length&&e.target.classList.add("over")},f=function(e){e.preventDefault(),e.target.classList.contains("over")&&e.target.classList.remove("over")},m=function(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",!1},p=function(e){return e.preventDefault&&e.preventDefault(),!1},g=null,h=function(e){e.preventDefault();var t=e.target;if(null!==(g=e.dataTransfer.getData("text"))&&""!==g.trim()){var n=document.querySelector('.tile[data-tile-id="'+g+'"]'),o=n.parentElement.dataset.row,a=n.parentElement.dataset.column,l=t.dataset.row,i=t.dataset.column,c=Number(l)-Number(o),u=Number(i)-Number(a),d=null,s=Array.from(document.querySelectorAll(".selected"));for(r=s.map((function(e){return{id:e.dataset.tileId,row:e.parentElement.dataset.row,column:e.parentElement.dataset.column}}));d!=r.length;){d=r.length;for(var f=0;f<d;f+=1){var m=r.shift(),p=document.querySelector('.tile[data-tile-id="'+m.id+'"]');o=p.parentElement.dataset.row,a=p.parentElement.dataset.column,l=c+Number(o),i=u+Number(a);var h=document.querySelector('#board .cell[data-row="'+l+'"][data-column="'+i+'"]');h.children.length>0?r.push(m):(h.appendChild(p),t.classList.remove("over"),t.classList.add("filled"),p.dataset.row=l,p.dataset.column=i)}}r=[],b(),y("tile")}else t.classList.contains("over")&&t.classList.remove("over")},y=function(e){Array.from(document.querySelectorAll("."+e)).forEach((function(e){e.classList.remove("selected"),e.style.opacity=""}))},b=function(){var e=document.querySelector("#bench"),t=[];Array.prototype.forEach.call(e.children,(function(e,n){0==e.children.length&&t.push(e)})),Array.prototype.forEach.call(t,(function(t,n){e.removeChild(t)})),Array.from(e.children).forEach((function(e,t){e.dataset.column=t.toString()}))},v=function(e){a.style.display="show"===e?"block":"none",o=!o}},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return r}));const r=35,o=35;var a=function(e){var t=[],n=parseInt(e.getAttribute("data-row")),a=parseInt(e.getAttribute("data-column")),l=document.querySelector("#board");return n>0&&t.push(l.querySelectorAll('.cell[data-row="'+(n-1)+'"][data-column="'+a+'"]')[0]),n<r-1&&t.push(l.querySelectorAll('.cell[data-row="'+(n+1)+'"][data-column="'+a+'"]')[0]),a>0&&t.push(l.querySelectorAll('.cell[data-row="'+n+'"][data-column="'+(a-1)+'"]')[0]),a<o-1&&t.push(l.querySelectorAll('.cell[data-row="'+n+'"][data-column="'+(a+1)+'"]')[0]),t},l=function(){var e=document.querySelector("#board");if(document.getElementById("bench").children.length>0)return!1;var t=[],n=[];for(t.push(e.querySelectorAll(".tile")[0]);t.length>0;){var r=t.pop();n.includes(r)||n.push(r),Array.from(a(r)).forEach((function(e){if(e.children.length>0){var r=e.children[0];n.includes(r)||t.push(r)}}))}return console.log("Seen tiles "+n.length),console.log("All tiles "+e.querySelectorAll(".tile").length),n.length===e.querySelectorAll(".tile").length},i=function(){for(var e=[],t=document.querySelector("#board"),n=0;n<r;n++)for(var a="",l=0;l<o;l++){(i=t.querySelectorAll('.cell[data-row="'+n+'"][data-column="'+l+'"]')[0]).children.length>0?a+=i.children[0].textContent:(a.length>1&&e.push(a),a="")}for(l=0;l<o;l++)for(a="",n=0;n<r;n++){var i;(i=t.querySelectorAll('.cell[data-row="'+n+'"][data-column="'+l+'"]')[0]).children.length>0?a+=i.children[0].textContent:(a.length>1&&e.push(a),a="")}return e},c=function(e,t){for(var n=e.slice(),r=0,o=t;r<o.length;r++){var a=o[r],l=n.indexOf(a);l>-1&&n.splice(l,1)}return n}},,function(e,t,n){"use strict";n.r(t),n.d(t,"dev_join",(function(){return A})),n.d(t,"player_join",(function(){return w})),n.d(t,"load_game",(function(){return _})),n.d(t,"start_game",(function(){return E})),n.d(t,"split",(function(){return S})),n.d(t,"peel",(function(){return L})),n.d(t,"reset",(function(){return x})),n.d(t,"bananagrams",(function(){return j})),n.d(t,"continue_game",(function(){return O})),n.d(t,"swap",(function(){return q})),n.d(t,"socket_state",(function(){return f}));var r=n(0),o=n(1),a=0,l=function(e){var t=[];return Array.prototype.forEach.call(e,(function(e,n){t.push('<div class="cell" data-row="0" data-column="'+n+'"><span class="tile" data-tile-id="'+a+'" draggable="true">'+e+"</span></div>"),a+=1})),t},i=function(){Array.from(Array.from(document.querySelectorAll(".tile"))).forEach((function(e){e.addEventListener("dragstart",r.h,r.l),e.addEventListener("dblclick",r.c),e.addEventListener("click",r.b,r.l),e.addEventListener("dragend",r.d,r.l)}))};function c(e,t,n){console.log(e);var r=e.players[t];if("IDLE"==e.state)d(),$("#join_game").hide(),$(".lobby").show(),$("#options").show(),$("#start_game_button").show();else if("ACTIVE"==e.state){$("#gameplay").show(),$(".lobby").hide(),d(),$("#options").show(),$("#peel_button").show(),$("#swap_button").show(),$("#select_button").show(),$("#tiles_remaining").show(),document.getElementById("tiles_remaining_count").textContent=e.tiles_remaining;var a=Object(o.b)(r,n);n=r,s("bench",l(a)),i()}else if("ENDGAME"==e.state){d(),Array.from(document.querySelectorAll(".tile")).forEach((function(e){e.draggable=!0})),$("#gameplay").show(),$(".lobby").hide(),$("#game-over").hide(),$("#options").show(),$("#swap_button").show(),$("#bananagrams_button").show(),$("#select_button").show();a=Object(o.b)(r,n);n=r,s("bench",l(a)),i()}else if("OVER"==e.state){d(),Array.from(document.querySelectorAll(".tile")).forEach((function(e){e.draggable=!1})),$("#game-over").show(),$("#gameplay").hide(),$(".lobby").hide(),$("#options").show(),$("#continue_game_button").show(),document.getElementById("winning_player").textContent=e.winning_player+" has called Bananagrams. Verify their board and either continue the game or start a new one!";var c=document.getElementById("winning-words");c.innerHTML="",e.winning_words.forEach((function(e){e[1]?c.innerHTML+='<p style="color: green">'+e[0]+"</p>":c.innerHTML+='<p style="color: red">'+e[0]+"</p>"}))}else u("An error occurred: Unknown client state.");return n}function u(e){$("#error").html(e)}function d(){$("#start_game_button").hide(),$("#split_button").hide(),$("#peel_button").hide(),$("#swap_button").hide(),$("#select_button").hide(),$("#bananagrams_button").hide(),$("#continue_game_button").hide(),$("#tiles_remaining").hide()}var s=function(e,t){var n=document.getElementById(e);t.forEach((function(e){n.innerHTML+=e}))},f={player_id:null,game_state:null,dev:!1};let m=[],p=null;const g=window.location.href.split("/"),h=g[g.length-1],y=document.querySelector(".menu");let b=!1;const v=io();function _(){v.emit("load_game",{name:h})}function w(){f.player_id=document.getElementById("player_id").value,localStorage.setItem("player_id",f.player_id),v.emit("player_join",{name:h,player_id:f.player_id}),b=!0}function A(){f.player_id="dev_p1",f.dev=!0,b=!0,_()}function E(){v.emit("start_game",{name:h})}function S(){v.emit("split",{name:h})}function L(){f.dev||Object(o.d)()?v.emit("peel",{name:h}):alert("Your bench must be empty and your board must be valid.")}function q(){if(f.game_state.tiles_remaining<3)alert("Less that 3 tiles remaining, cannot swap.");else{var e=y.getAttribute("active-tile-id"),t=document.querySelector('.tile[data-tile-id="'+e+'"]');try{var n=t.textContent}catch(e){return void alert("No tile selected for swapping, double click a tile to select!")}t.parentNode.removeChild(t);var o=m.indexOf(n);-1!==o&&m.splice(o,1),v.emit("swap",{name:h,letter:n,player_id:f.player_id}),Object(r.a)()}}function j(){if(f.dev||Object(o.d)()){var e=Object(o.c)();v.emit("bananagrams",{name:h,player_id:f.player_id,words:e})}else alert("Your bench must be empty and your board must be valid.")}function O(){v.emit("continue_game",{name:h})}function x(){Array.from(document.querySelectorAll(".tile")).forEach((function(e){e.parentNode.removeChild(e)})),Object(r.a)(),m=[],v.emit("reset",{name:h})}v.on("connect",(function(){v.emit("join",{name:h}),_()})),v.on("render_game",(function(e){if(e.hasOwnProperty("status_code"))if(200==e.status_code){f.game_state=JSON.parse(e.payload),p=f.game_state.players;var t=document.getElementById("players");if(t.innerHTML="",Object.entries(p).forEach((function(e){t.innerHTML+="<li>"+e[0]+"</li>"})),!b)return;m=c(f.game_state,f.player_id,m)}else e.hasOwnProperty("message")?u("An error occurred: "+e.message):u("An error occurred, but no message was given.");else u("Did not recieve a response from the server.")}))}])}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vLi90cy9ldmVudHMudHMiLCJ3ZWJwYWNrOi8vLy4vdHMvaGVscGVycy50cyIsIndlYnBhY2s6Ly8vLi90cy9yZW5kZXIudHMiLCJ3ZWJwYWNrOi8vLy4vdHMvc29ja2V0LnRzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsImEiLCJpIiwid2luZG93IiwiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwidGlsZXNUb0RyYWciLCJtZW51VmlzaWJsZSIsIm1lbnUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJvcHRpb25zIiwiaGFuZGxlQ2xpY2siLCJlIiwicHJldmVudERlZmF1bHQiLCJjbGFzc2VzIiwidGFyZ2V0IiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJyZW1vdmUiLCJhZGQiLCJoYW5kbGVEcmFnU3RhcnQiLCJzdHlsZSIsIm9wYWNpdHkiLCJjdXJzb3IiLCJkYXRhVHJhbnNmZXIiLCJkcm9wRWZmZWN0IiwiZWZmZWN0QWxsb3dlZCIsInNldERhdGEiLCJkYXRhc2V0IiwidGlsZUlkIiwiaGFuZGxlRHJhZ0VuZCIsImhhbmRsZURvdWJsZUNsaWNrIiwic2V0QXR0cmlidXRlIiwiZ2V0QXR0cmlidXRlIiwiaGFuZGxlRHJhZ0VudGVyIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJoYW5kbGVEcmFnTGVhdmUiLCJoYW5kbGVEcmFnT3ZlciIsImhhbmRsZU9uTW91c2VEb3duIiwiaWQiLCJoYW5kbGVEcm9wIiwicHJpbWFyeURlc3RpbmF0aW9uQ2VsbCIsImdldERhdGEiLCJ0cmltIiwicHJpbWFyeVRpbGUiLCJzb3VyY2VSb3ciLCJwYXJlbnRFbGVtZW50Iiwicm93Iiwic291cmNlQ29sdW1uIiwiY29sdW1uIiwiZGVzdGluYXRpb25Sb3ciLCJkZXN0aW5hdGlvbkNvbHVtbiIsInJvd0NoYW5nZSIsIk51bWJlciIsImNvbHVtbkNoYW5nZSIsInF1ZXVlTGVuZ3RoIiwic2VsZWN0ZWRUaWxlcyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJtYXAiLCJ0aWxlIiwidGlsZURhdGEiLCJzaGlmdCIsInNlY29uZGFyeVRpbGUiLCJzZWNvbmRhcnlEZXN0aW5hdGlvbiIsInB1c2giLCJhcHBlbmRDaGlsZCIsImNsZWFuQmVuY2giLCJyZXNldE1vZGlmaWVycyIsImNsYXNzTmFtZSIsImZvckVhY2giLCJlbGVtZW50IiwiYmVuY2giLCJlbXB0eUNlbGxzIiwiY2VsbCIsImluZGV4IiwicmVtb3ZlQ2hpbGQiLCJiZW5jaENlbGwiLCJ0b1N0cmluZyIsInRvZ2dsZU1lbnUiLCJjb21tYW5kIiwiZGlzcGxheSIsInJvd3MiLCJjb2x1bW5zIiwiZ2V0VGlsZU5laWdoYm9ycyIsIm5laWdoYm9ycyIsInRpbGVSb3ciLCJwYXJzZUludCIsInRpbGVDb2x1bW4iLCJib2FyZCIsImlzVmFsaWRCb2FyZCIsImdldEVsZW1lbnRCeUlkIiwicHJvY2Vzc1RpbGVzIiwic2VlblRpbGVzIiwiY3VyVGlsZSIsInBvcCIsImluY2x1ZGVzIiwibmVpZ2hib3IiLCJjaGlsZFRpbGUiLCJjb25zb2xlIiwibG9nIiwiZ2V0QWxsV29yZHMiLCJhbGxXb3JkcyIsImN1cldvcmQiLCJjdXJDZWxsIiwidGV4dENvbnRlbnQiLCJmaW5kRGlmZmVyZW5jZSIsImIiLCJyZXQiLCJzbGljZSIsIl9pIiwiYl8xIiwidmFsIiwiaW5kZXhPZiIsInNwbGljZSIsIm51bWJlck9mVGlsZXMiLCJjcmVhdGVUaWxlcyIsImxldHRlcnNBcnJheSIsInRpbGVzQXJyYXkiLCJsZXR0ZXIiLCJhZGRUaWxlTGlzdGVuZXIiLCJhZGRFdmVudExpc3RlbmVyIiwicmVuZGVyX2dhbWUiLCJyZXNwIiwicGxheWVyX2lkIiwidGlsZXMiLCJjdXJfdGlsZXMiLCJoaWRlQnV0dG9ucyIsIiQiLCJoaWRlIiwic2hvdyIsIm5ld1RpbGVzIiwicG9wdWxhdGUiLCJkcmFnZ2FibGUiLCJ3aW5uaW5nV29yZHNMaXN0IiwiaW5uZXJIVE1MIiwid29yZF9wYWlyIiwic2hvd0Vycm9yIiwibXNnIiwiaHRtbCIsInBhcmVudGlkIiwiY2hpbGRyZW5BcnJheSIsInBhcmVudCIsImNoaWxkIiwic29ja2V0X3N0YXRlIiwicGxheWVycyIsImhyZWZfcGFydHMiLCJsb2NhdGlvbiIsImhyZWYiLCJzcGxpdCIsImdhbWVfbmFtZSIsImhhc0pvaW5lZCIsInNvY2tldCIsImlvIiwibG9hZF9nYW1lIiwiZW1pdCIsInBsYXllcl9qb2luIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsImRldl9qb2luIiwiZGV2Iiwic3RhcnRfZ2FtZSIsInBlZWwiLCJhbGVydCIsInN3YXAiLCJnYW1lX3N0YXRlIiwiYWN0aXZlX3RpbGVfaWQiLCJ0aWxlVG9SZW1vdmUiLCJUeXBlRXJyb3IiLCJwYXJlbnROb2RlIiwiYmFuYW5hZ3JhbXMiLCJ3b3JkcyIsImNvbnRpbnVlX2dhbWUiLCJvbiIsIkpTT04iLCJwYXJzZSIsInBheWxvYWQiLCJwbGF5ZXJfbGlzdF8xIiwiZW50cmllcyIsInBsYXllciJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBMkNBLEVBQU1DLEdBQ2hELEdBQXNCLGlCQUFaQyxTQUEwQyxpQkFBWEMsT0FDeENBLE9BQU9E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QU9HLEtBQUssY0FBZSxDQUN2QixLQUFRTCxFQUNSLFVBQWFOLEVBQWFwQixVQUMxQixNQUFTK0MsU0FQVFIsTUFBTSwwREFZZCxTQUFTUyxJQUNMcEIsRUFBT0csS0FBSyxnQkFBaUIsQ0FDekIsS0FBUUwsSUFLaEIsU0FBUyxJQUNMOUYsTUFBTUMsS0FBS25ELFNBQVNvRCxpQkFBaUIsVUFBVVksU0FBUSxTQUFVVixHQUM3REEsRUFBSzZHLFdBQVc3RixZQUFZaEIsTUFFaEMsY0FDQSxFQUFRLEdBQ1I0RixFQUFPRyxLQUFLLFFBQVMsQ0FDakIsS0FBUUwsSUFwSmhCRSxFQUFPcUIsR0FBRyxXQUFXLFdBQ2pCckIsRUFBT0csS0FBSyxPQUFRLENBQ2hCLEtBQVFMLElBRVpJLE9BS0pGLEVBQU9xQixHQUFHLGVBQWUsU0FBVWxELEdBQy9CLEdBQUtBLEVBQUszSCxlQUFlLGVBSXJCLEdBQTJCLEtBQXZCMkgsRUFBa0IsWUFBVSxDQUM1QnFCLEVBQWFxQixXQUFhUyxLQUFLQyxNQUFNcEQsRUFBS3FELFNBRTFDL0IsRUFBVUQsRUFBYXFCLFdBQW9CLFFBQzNDLElBQUlZLEVBQWdCM0ssU0FBU3FGLGVBQWUsV0FLNUMsR0FKQXNGLEVBQWMxQyxVQUFZLEdBQzFCMUosT0FBT3FNLFFBQVFqQyxHQUFTM0UsU0FBUSxTQUFVNkcsR0FDdENGLEVBQWMxQyxXQUFhLE9BQVM0QyxFQUFPLEdBQUssWUFFL0M1QixFQUNELE9BR0EsRUFBUTdCLEVBQVlzQixFQUFhcUIsV0FBV3JCLEVBQWFwQixVQUFXLFFBSW5FRCxFQUFLM0gsZUFBZSxXQUlyQnlJLEVBQVUsc0JBQXdCZCxFQUFjLFNBSGhEYyxFQUFVLHFEQXJCbEJBLEVBQVUiLCJmaWxlIjoic29ja2V0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xuXHRlbHNlIHtcblx0XHR2YXIgYSA9IGZhY3RvcnkoKTtcblx0XHRmb3IodmFyIGkgaW4gYSkgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyA/IGV4cG9ydHMgOiByb290KVtpXSA9IGFbaV07XG5cdH1cbn0pKHdpbmRvdywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDMpO1xuIiwiLyoqXHJcbiAqIFRoZSBldmVudHMgdGhhdCBoYW5kbGUgdGhlIGludGVyYWN0aXZpdHkgb2YgdGhlIGdhbWUuXHJcbiAqXHJcbiAqL1xyXG5cclxuXHJcbi8vIEdsb2JhbCBhcnJheSB1c2VkIHRvIG1hbmFnZSB0aGUgZHJhZyBhbmQgZHJvcC5cclxubGV0IHRpbGVzVG9EcmFnID0gW107XHJcbmxldCBtZW51VmlzaWJsZSA9IGZhbHNlO1xyXG5jb25zdCBtZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZW51XCIpO1xyXG5jb25zdCBvcHRpb25zID0gZmFsc2U7XHJcblxyXG52YXIgaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdmFyIGNsYXNzZXMgPSBlLnRhcmdldC5jbGFzc0xpc3Q7XHJcbiAgICBjbGFzc2VzLmNvbnRhaW5zKCdzZWxlY3RlZCcpID8gY2xhc3Nlcy5yZW1vdmUoJ3NlbGVjdGVkJykgOiBjbGFzc2VzLmFkZCgnc2VsZWN0ZWQnKTtcclxufTtcclxuXHJcbnZhciBoYW5kbGVEcmFnU3RhcnQgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgZS50YXJnZXQuc3R5bGUub3BhY2l0eSA9IC40O1xyXG4gICAgaWYgKCFlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuYWRkKFwic2VsZWN0ZWRcIik7XHJcbiAgICB9XHJcblxyXG4gICAgZS50YXJnZXQuc3R5bGUuY3Vyc29yID0gXCJncmFiYmluZ1wiO1xyXG4gICAgZS5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9IFwiY29weVwiO1xyXG4gICAgZS5kYXRhVHJhbnNmZXIuZWZmZWN0QWxsb3dlZCA9IFwibW92ZVwiO1xyXG4gICAgZS5kYXRhVHJhbnNmZXIuc2V0RGF0YShcInRleHRcIiwgZS50YXJnZXQuZGF0YXNldC50aWxlSWQpO1xyXG59O1xyXG5cclxudmFyIGhhbmRsZURyYWdFbmQgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgZS50YXJnZXQuc3R5bGUub3BhY2l0eSA9IFwiXCI7XHJcbn07XHJcblxyXG52YXIgaGFuZGxlRG91YmxlQ2xpY2sgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgLy8gQWx3YXlzIHJlbW92ZSBzZWxlY3RlZCBjbGFzcyBvbiBkb3VibGUgY2xpY2tcclxuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJzZWxlY3RlZFwiKSkge1xyXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoXCJzZWxlY3RlZFwiKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBUb2dnbGUgdGhlIHNlbGVjdGVkIHN3YXAgbGFiZWxcclxuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJzd2FwXCIpKSB7XHJcbiAgICAgICAgbWVudS5zZXRBdHRyaWJ1dGUoXCJhY3RpdmUtdGlsZS1pZFwiLCBudWxsKTtcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKFwic3dhcFwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbWVudS5zZXRBdHRyaWJ1dGUoXCJhY3RpdmUtdGlsZS1pZFwiLCBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXRpbGUtaWRcIikpO1xyXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoXCJzd2FwXCIpO1xyXG4gICAgfVxyXG59O1xyXG5cclxudmFyIGhhbmRsZURyYWdFbnRlciA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBpZiAoZS50YXJnZXQuY2hpbGRyZW4ubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmFkZChcIm92ZXJcIik7XHJcbiAgICB9XHJcbn07XHJcblxyXG52YXIgaGFuZGxlRHJhZ0xlYXZlID0gZnVuY3Rpb24gKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJvdmVyXCIpKSB7XHJcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LnJlbW92ZShcIm92ZXJcIik7XHJcbiAgICB9XHJcbn07XHJcblxyXG52YXIgaGFuZGxlRHJhZ092ZXIgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgaWYgKGUucHJldmVudERlZmF1bHQpXHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgZS5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9IFwibW92ZVwiO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59O1xyXG52YXIgaGFuZGxlT25Nb3VzZURvd24gPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgaWYgKGUucHJldmVudERlZmF1bHQpXHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59O1xyXG5cclxudmFyIGlkID0gbnVsbDtcclxudmFyIGhhbmRsZURyb3AgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdmFyIHByaW1hcnlEZXN0aW5hdGlvbkNlbGwgPSBlLnRhcmdldDtcclxuICAgIC8vIEdldCB0aGUgdGlsZSBJRCBhbmQgaGFuZGxlIHRoZSBudWxsIGNhc2VcclxuICAgIGlkID0gZS5kYXRhVHJhbnNmZXIuZ2V0RGF0YSgndGV4dCcpO1xyXG4gICAgaWYgKGlkID09PSBudWxsIHx8IGlkLnRyaW0oKSA9PT0gXCJcIikge1xyXG4gICAgICAgIGlmIChwcmltYXJ5RGVzdGluYXRpb25DZWxsLmNsYXNzTGlzdC5jb250YWlucyhcIm92ZXJcIikpIHtcclxuICAgICAgICAgICAgcHJpbWFyeURlc3RpbmF0aW9uQ2VsbC5jbGFzc0xpc3QucmVtb3ZlKFwib3ZlclwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdmFyIHByaW1hcnlUaWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50aWxlW2RhdGEtdGlsZS1pZD1cXFwiXCIgKyBpZCArIFwiXFxcIl1cIik7XHJcbiAgICB2YXIgc291cmNlUm93ID0gcHJpbWFyeVRpbGUucGFyZW50RWxlbWVudC5kYXRhc2V0LnJvdztcclxuICAgIHZhciBzb3VyY2VDb2x1bW4gPSBwcmltYXJ5VGlsZS5wYXJlbnRFbGVtZW50LmRhdGFzZXQuY29sdW1uO1xyXG4gICAgdmFyIGRlc3RpbmF0aW9uUm93ID0gcHJpbWFyeURlc3RpbmF0aW9uQ2VsbC5kYXRhc2V0LnJvdztcclxuICAgIHZhciBkZXN0aW5hdGlvbkNvbHVtbiA9IHByaW1hcnlEZXN0aW5hdGlvbkNlbGwuZGF0YXNldC5jb2x1bW47XHJcbiAgICB2YXIgcm93Q2hhbmdlID0gTnVtYmVyKGRlc3RpbmF0aW9uUm93KSAtIE51bWJlcihzb3VyY2VSb3cpO1xyXG4gICAgdmFyIGNvbHVtbkNoYW5nZSA9IE51bWJlcihkZXN0aW5hdGlvbkNvbHVtbikgLSBOdW1iZXIoc291cmNlQ29sdW1uKTtcclxuICAgIHZhciBxdWV1ZUxlbmd0aCA9IG51bGw7XHJcblxyXG4gICAgdmFyIHNlbGVjdGVkVGlsZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWxlY3RlZCcpKTtcclxuXHJcbiAgICAvLyBjYXNpbmcgb2YgdGlsZUlkIGlzIHNldCBieSBicm93c2VyIHBhcnNpbmdcclxuICAgIHRpbGVzVG9EcmFnID0gc2VsZWN0ZWRUaWxlcy5tYXAoZnVuY3Rpb24gKHRpbGUpIHtcclxuICAgICAgICB2YXIgdGlsZURhdGEgPSB7XHJcbiAgICAgICAgICAgIGlkOiAodGlsZSBhcyBIVE1MRWxlbWVudCkuZGF0YXNldC50aWxlSWQsXHJcbiAgICAgICAgICAgIHJvdzogdGlsZS5wYXJlbnRFbGVtZW50LmRhdGFzZXQucm93LFxyXG4gICAgICAgICAgICBjb2x1bW46IHRpbGUucGFyZW50RWxlbWVudC5kYXRhc2V0LmNvbHVtblxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHRpbGVEYXRhO1xyXG4gICAgfSk7XHJcbiAgICAvLyBDb250aW51b3VzbHkgdHJ5IGFuZCBtb3ZlIHRpbGVzIG9uZSBieSBvbmUgdW50aWwgbm8gcHJvZ3Jlc3MgaXMgbWFkZS5cclxuICAgIHdoaWxlIChxdWV1ZUxlbmd0aCAhPSB0aWxlc1RvRHJhZy5sZW5ndGgpIHtcclxuICAgICAgICBxdWV1ZUxlbmd0aCA9IHRpbGVzVG9EcmFnLmxlbmd0aDtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHF1ZXVlTGVuZ3RoOyBpICs9IDEpIHtcclxuICAgICAgICAgICAgdmFyIHRpbGVEYXRhID0gdGlsZXNUb0RyYWcuc2hpZnQoKTtcclxuICAgICAgICAgICAgdmFyIHNlY29uZGFyeVRpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRpbGVbZGF0YS10aWxlLWlkPVxcXCJcIiArIHRpbGVEYXRhLmlkICsgXCJcXFwiXVwiKTtcclxuICAgICAgICAgICAgc291cmNlUm93ID0gc2Vjb25kYXJ5VGlsZS5wYXJlbnRFbGVtZW50LmRhdGFzZXQucm93O1xyXG4gICAgICAgICAgICBzb3VyY2VDb2x1bW4gPSBzZWNvbmRhcnlUaWxlLnBhcmVudEVsZW1lbnQuZGF0YXNldC5jb2x1bW47XHJcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uUm93ID0gcm93Q2hhbmdlICsgTnVtYmVyKHNvdXJjZVJvdyk7XHJcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uQ29sdW1uID0gY29sdW1uQ2hhbmdlICsgTnVtYmVyKHNvdXJjZUNvbHVtbik7XHJcbiAgICAgICAgICAgIHZhciBzZWNvbmRhcnlEZXN0aW5hdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYm9hcmQgLmNlbGxbZGF0YS1yb3c9XFxcIlwiICsgZGVzdGluYXRpb25Sb3cgKyBcIlxcXCJdW2RhdGEtY29sdW1uPVxcXCJcIiArIGRlc3RpbmF0aW9uQ29sdW1uICsgXCJcXFwiXVwiKTtcclxuICAgICAgICAgICAgaWYgKHNlY29uZGFyeURlc3RpbmF0aW9uLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHRpbGVzVG9EcmFnLnB1c2godGlsZURhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc2Vjb25kYXJ5RGVzdGluYXRpb24uYXBwZW5kQ2hpbGQoc2Vjb25kYXJ5VGlsZSk7XHJcbiAgICAgICAgICAgICAgICBwcmltYXJ5RGVzdGluYXRpb25DZWxsLmNsYXNzTGlzdC5yZW1vdmUoXCJvdmVyXCIpO1xyXG4gICAgICAgICAgICAgICAgcHJpbWFyeURlc3RpbmF0aW9uQ2VsbC5jbGFzc0xpc3QuYWRkKFwiZmlsbGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgKHNlY29uZGFyeVRpbGUgYXMgSFRNTEVsZW1lbnQpLmRhdGFzZXQucm93ID0gZGVzdGluYXRpb25Sb3c7XHJcbiAgICAgICAgICAgICAgICAoc2Vjb25kYXJ5VGlsZSBhcyBIVE1MRWxlbWVudCkuZGF0YXNldC5jb2x1bW4gPSBkZXN0aW5hdGlvbkNvbHVtbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHRpbGVzVG9EcmFnID0gW107XHJcbiAgICBjbGVhbkJlbmNoKCk7XHJcbiAgICByZXNldE1vZGlmaWVycygndGlsZScpO1xyXG59O1xyXG5cclxudmFyIHJlc2V0TW9kaWZpZXJzID0gZnVuY3Rpb24gKGNsYXNzTmFtZSkge1xyXG4gICAgdmFyIGVsZW1lbnRzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLlwiICsgY2xhc3NOYW1lKSk7XHJcbiAgICBlbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwic2VsZWN0ZWRcIik7XHJcbiAgICAgICAgbGV0IGh0bWxFbGVtZW50ID0gPEhUTUxFbGVtZW50PmVsZW1lbnQ7XHJcbiAgICAgICAgaHRtbEVsZW1lbnQuc3R5bGUub3BhY2l0eSA9IFwiXCI7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbnZhciBzZXRQb3NpdGlvbiA9IGZ1bmN0aW9uIChfYSkge1xyXG4gICAgdmFyIHRvcCA9IF9hLnRvcCwgbGVmdCA9IF9hLmxlZnQ7XHJcbiAgICAobWVudSBhcyBIVE1MRWxlbWVudCkuc3R5bGUubGVmdCA9IGxlZnQgKyBcInB4XCI7XHJcbiAgICAobWVudSBhcyBIVE1MRWxlbWVudCkuc3R5bGUudG9wID0gdG9wICsgXCJweFwiO1xyXG4gICAgdG9nZ2xlTWVudSgnc2hvdycpO1xyXG59O1xyXG5cclxudmFyIGNsZWFuQmVuY2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYmVuY2ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2JlbmNoXCIpO1xyXG4gICAgLy8gQ3JlYXRlIGEgbGlzdCBvZiBhbGwgZW1wdHkgY2hpbGRyZW5cclxuICAgIHZhciBlbXB0eUNlbGxzID0gW107XHJcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGJlbmNoLmNoaWxkcmVuLCBmdW5jdGlvbiAoY2VsbCwgaW5kZXgpIHtcclxuICAgICAgICBpZiAoY2VsbC5jaGlsZHJlbi5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICBlbXB0eUNlbGxzLnB1c2goY2VsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvLyBSZW1vdmUgZWFjaCBlbXB0eSBjaGlsZCBmcm9tIHRoZSBiZW5jaFxyXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChlbXB0eUNlbGxzLCBmdW5jdGlvbiAoY2VsbCwgaW5kZXgpIHtcclxuICAgICAgICBiZW5jaC5yZW1vdmVDaGlsZChjZWxsKTtcclxuICAgIH0pO1xyXG4gICAgLy8gcmVjYWxjdWxhdGUgcm93IGFuZCBjb2x1bW5zIG9mIGJlbmNoXHJcbiAgICBBcnJheS5mcm9tKGJlbmNoLmNoaWxkcmVuKS5mb3JFYWNoKGZ1bmN0aW9uIChiZW5jaENlbGwsIGluZGV4KSB7XHJcbiAgICAgICAgKGJlbmNoQ2VsbCBhcyBIVE1MRWxlbWVudCkuZGF0YXNldC5jb2x1bW4gPSBpbmRleC50b1N0cmluZygpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG52YXIgdG9nZ2xlTWVudSA9IGZ1bmN0aW9uIChjb21tYW5kKSB7XHJcbiAgICAobWVudSBhcyBIVE1MRWxlbWVudCkuc3R5bGUuZGlzcGxheSA9IGNvbW1hbmQgPT09IFwic2hvd1wiID8gXCJibG9ja1wiIDogXCJub25lXCI7XHJcbiAgICBtZW51VmlzaWJsZSA9ICFtZW51VmlzaWJsZTtcclxufTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgICBjbGVhbkJlbmNoLFxyXG4gICAgaGFuZGxlQ2xpY2ssXHJcbiAgICBoYW5kbGVEb3VibGVDbGljayxcclxuICAgIGhhbmRsZURyYWdFbmQsXHJcbiAgICBoYW5kbGVEcmFnRW50ZXIsXHJcbiAgICBoYW5kbGVEcmFnU3RhcnQsXHJcbiAgICBoYW5kbGVEcmFnTGVhdmUsXHJcbiAgICBoYW5kbGVEcmFnT3ZlcixcclxuICAgIGhhbmRsZU9uTW91c2VEb3duLFxyXG4gICAgaGFuZGxlRHJvcCxcclxuICAgIHJlc2V0TW9kaWZpZXJzLFxyXG4gICAgdG9nZ2xlTWVudSxcclxuICAgIG1lbnVWaXNpYmxlLFxyXG4gICAgb3B0aW9uc1xyXG59OyIsIi8qKioqKioqKioqKioqKioqKioqKipcclxuICpcclxuICogIEdlbmVyYWwgaGVscGVyIGZ1bmN0aW9uc1xyXG4gKlxyXG4gKioqKioqKioqKioqKioqKioqKioqL1xyXG5cclxuY29uc3Qgcm93cyA9IDM1O1xyXG5jb25zdCBjb2x1bW5zID0gMzU7XHJcblxyXG5cclxudmFyIGlzSGFzaE1hcCA9IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICByZXR1cm4gKCFBcnJheS5pc0FycmF5KGl0ZW0pICYmIHR5cGVvZiAoaXRlbSkgPT09ICdvYmplY3QnKTtcclxufTtcclxuXHJcbnZhciBzYXZlVG9Mb2NhbFN0b3JhZ2UgPSBmdW5jdGlvbiAoa2V5LCByYXdEYXRhKSB7XHJcbiAgICB2YXIgZGF0YSA9IHJhd0RhdGE7XHJcbiAgICBpZiAoaXNIYXNoTWFwKGRhdGEpKSB7XHJcbiAgICAgICAgZGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xyXG4gICAgfVxyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBkYXRhKTtcclxufTtcclxuXHJcbnZhciBnZXRUaWxlTmVpZ2hib3JzID0gZnVuY3Rpb24gKHRpbGUpIHtcclxuICAgIHZhciBuZWlnaGJvcnMgPSBbXTtcclxuICAgIHZhciB0aWxlUm93ID0gcGFyc2VJbnQodGlsZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXJvd1wiKSk7XHJcbiAgICB2YXIgdGlsZUNvbHVtbiA9IHBhcnNlSW50KHRpbGUuZ2V0QXR0cmlidXRlKFwiZGF0YS1jb2x1bW5cIikpO1xyXG4gICAgdmFyIGJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNib2FyZFwiKTtcclxuICAgIC8vIEJhc2VkIG9uIHRoZSByb3cgYW5kIGNvbHVtbiB2YWx1ZXMsIGdldCB0aGUgYXBwcm9wcmlhdGUgbmVpZ2hib3JzXHJcbiAgICBpZiAodGlsZVJvdyA+IDApIHtcclxuICAgICAgICBuZWlnaGJvcnMucHVzaChib2FyZC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNlbGxbZGF0YS1yb3c9XFxcIlwiICsgKHRpbGVSb3cgLSAxKSArIFwiXFxcIl1bZGF0YS1jb2x1bW49XFxcIlwiICsgdGlsZUNvbHVtbiArIFwiXFxcIl1cIilbMF0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRpbGVSb3cgPCByb3dzIC0gMSkge1xyXG4gICAgICAgIG5laWdoYm9ycy5wdXNoKGJvYXJkLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2VsbFtkYXRhLXJvdz1cXFwiXCIgKyAodGlsZVJvdyArIDEpICsgXCJcXFwiXVtkYXRhLWNvbHVtbj1cXFwiXCIgKyB0aWxlQ29sdW1uICsgXCJcXFwiXVwiKVswXSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGlsZUNvbHVtbiA+IDApIHtcclxuICAgICAgICBuZWlnaGJvcnMucHVzaChib2FyZC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNlbGxbZGF0YS1yb3c9XFxcIlwiICsgdGlsZVJvdyArIFwiXFxcIl1bZGF0YS1jb2x1bW49XFxcIlwiICsgKHRpbGVDb2x1bW4gLSAxKSArIFwiXFxcIl1cIilbMF0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRpbGVDb2x1bW4gPCBjb2x1bW5zIC0gMSkge1xyXG4gICAgICAgIG5laWdoYm9ycy5wdXNoKGJvYXJkLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2VsbFtkYXRhLXJvdz1cXFwiXCIgKyB0aWxlUm93ICsgXCJcXFwiXVtkYXRhLWNvbHVtbj1cXFwiXCIgKyAodGlsZUNvbHVtbiArIDEpICsgXCJcXFwiXVwiKVswXSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmVpZ2hib3JzO1xyXG59O1xyXG5cclxudmFyIGlzVmFsaWRCb2FyZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYm9hcmRcIik7XHJcbiAgICAvLyBNYWtlIHN1cmUgdGhlIGJlbmNoIGlzIGVtcHR5XHJcbiAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiZW5jaFwiKS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLy8gVXNpbmcgYSBxdWV1ZSwgcHJvY2VzcyBlYWNoIHRpbGUgYW5kIG1ha2Ugc3VyZSB3ZSBjYW4gZ2V0IHRvIGV2ZXJ5IHRpbGVcclxuICAgIHZhciBwcm9jZXNzVGlsZXMgPSBbXTtcclxuICAgIHZhciBzZWVuVGlsZXMgPSBbXTtcclxuICAgIHByb2Nlc3NUaWxlcy5wdXNoKGJvYXJkLnF1ZXJ5U2VsZWN0b3JBbGwoXCIudGlsZVwiKVswXSk7XHJcbiAgICB3aGlsZSAocHJvY2Vzc1RpbGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICB2YXIgY3VyVGlsZSA9IHByb2Nlc3NUaWxlcy5wb3AoKTtcclxuICAgICAgICBpZiAoIXNlZW5UaWxlcy5pbmNsdWRlcyhjdXJUaWxlKSkge1xyXG4gICAgICAgICAgICBzZWVuVGlsZXMucHVzaChjdXJUaWxlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gR2V0IGFsbCBuZWlnaGJvcnMgb2YgdGhlIGN1cnJlbnQgdGlsZXMgYW5kIHB1c2ggdGhlbSBvbiBpZiB0aGV5IGhhdmVuJ3QgeWV0IGJlZW4gc2VlblxyXG4gICAgICAgIEFycmF5LmZyb20oZ2V0VGlsZU5laWdoYm9ycyhjdXJUaWxlKSkuZm9yRWFjaChmdW5jdGlvbiAobmVpZ2hib3IpIHtcclxuICAgICAgICAgICAgaWYgKG5laWdoYm9yLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGlsZFRpbGUgPSBuZWlnaGJvci5jaGlsZHJlblswXTtcclxuICAgICAgICAgICAgICAgIC8vIElmIHdlIGhhdmUgbm90IHlldCBzZWVuIHRoZSBwcm9jZXNzZWQgdGlsZSwgcHVzaCBpdCBvbnRvIHRoZSBxdWV1ZVxyXG4gICAgICAgICAgICAgICAgaWYgKCFzZWVuVGlsZXMuaW5jbHVkZXMoY2hpbGRUaWxlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NUaWxlcy5wdXNoKGNoaWxkVGlsZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8vIElmIHdlIGhpdCBldmVyeSB0aWxlLCB0aGVuIHdlIGhhdmUgYSB2YWxpZCBib2FyZFxyXG4gICAgY29uc29sZS5sb2coXCJTZWVuIHRpbGVzIFwiICsgc2VlblRpbGVzLmxlbmd0aCk7XHJcbiAgICBjb25zb2xlLmxvZyhcIkFsbCB0aWxlcyBcIiArIGJvYXJkLnF1ZXJ5U2VsZWN0b3JBbGwoXCIudGlsZVwiKS5sZW5ndGgpO1xyXG4gICAgcmV0dXJuIHNlZW5UaWxlcy5sZW5ndGggPT09IGJvYXJkLnF1ZXJ5U2VsZWN0b3JBbGwoXCIudGlsZVwiKS5sZW5ndGg7XHJcbn07XHJcblxyXG52YXIgZ2V0QWxsV29yZHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYWxsV29yZHMgPSBbXTtcclxuICAgIHZhciBib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYm9hcmRcIik7XHJcblxyXG4gICAgLy8gR2V0IGFsbCB3b3JkcyByb3cgd2lzZVxyXG4gICAgZm9yICh2YXIgciA9IDA7IHIgPCByb3dzOyByKyspIHtcclxuICAgICAgICB2YXIgY3VyV29yZCA9IFwiXCI7XHJcbiAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBjb2x1bW5zOyBjKyspIHtcclxuICAgICAgICAgICAgdmFyIGN1ckNlbGwgPSBib2FyZC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNlbGxbZGF0YS1yb3c9XFxcIlwiICsgciArIFwiXFxcIl1bZGF0YS1jb2x1bW49XFxcIlwiICsgYyArIFwiXFxcIl1cIilbMF07XHJcbiAgICAgICAgICAgIGlmIChjdXJDZWxsLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGN1cldvcmQgKz0gY3VyQ2VsbC5jaGlsZHJlblswXS50ZXh0Q29udGVudDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChjdXJXb3JkLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGxXb3Jkcy5wdXNoKGN1cldvcmQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY3VyV29yZCA9IFwiXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBHZXQgYWxsIGNvbHVtbiB3aXNlXHJcbiAgICBmb3IgKHZhciBjID0gMDsgYyA8IGNvbHVtbnM7IGMrKykge1xyXG4gICAgICAgIHZhciBjdXJXb3JkID0gXCJcIjtcclxuICAgICAgICBmb3IgKHZhciByID0gMDsgciA8IHJvd3M7IHIrKykge1xyXG4gICAgICAgICAgICB2YXIgY3VyQ2VsbCA9IGJvYXJkLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2VsbFtkYXRhLXJvdz1cXFwiXCIgKyByICsgXCJcXFwiXVtkYXRhLWNvbHVtbj1cXFwiXCIgKyBjICsgXCJcXFwiXVwiKVswXTtcclxuICAgICAgICAgICAgaWYgKGN1ckNlbGwuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY3VyV29yZCArPSBjdXJDZWxsLmNoaWxkcmVuWzBdLnRleHRDb250ZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1cldvcmQubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFsbFdvcmRzLnB1c2goY3VyV29yZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjdXJXb3JkID0gXCJcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBhbGxXb3JkcztcclxufTtcclxuXHJcbnZhciBmaW5kRGlmZmVyZW5jZSA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICB2YXIgcmV0ID0gYS5zbGljZSgpO1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBiXzEgPSBiOyBfaSA8IGJfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIgdmFsID0gYl8xW19pXTtcclxuICAgICAgICB2YXIgaW5kZXggPSByZXQuaW5kZXhPZih2YWwpO1xyXG4gICAgICAgIGlmIChpbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgIHJldC5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXQ7XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgICBmaW5kRGlmZmVyZW5jZSxcclxuICAgIGdldEFsbFdvcmRzLFxyXG4gICAgZ2V0VGlsZU5laWdoYm9ycyxcclxuICAgIGlzVmFsaWRCb2FyZCxcclxuICAgIGNvbHVtbnMsXHJcbiAgICByb3dzLFxyXG59OyIsIi8qKlxyXG4gKiBGdW5jdGlvbiB0aGF0IHJlbmRlcnMgdGhlIGdhbWUgYmFzZWQgb24gdGhlIGN1cnJlbnQgc3RhdGUuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHtcclxuICAgIGhhbmRsZUNsaWNrLFxyXG4gICAgaGFuZGxlRHJhZ1N0YXJ0LFxyXG4gICAgaGFuZGxlRHJhZ0VuZCxcclxuICAgIGhhbmRsZURvdWJsZUNsaWNrLFxyXG4gICAgb3B0aW9uc1xyXG59IGZyb20gJy4vZXZlbnRzJztcclxuaW1wb3J0IHsgZmluZERpZmZlcmVuY2UgfSBmcm9tIFwiLi9oZWxwZXJzXCI7XHJcblxyXG52YXIgbnVtYmVyT2ZUaWxlcyA9IDA7XHJcblxyXG52YXIgZW5hYmxlRHJhZ2dpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIudGlsZVwiKSkuZm9yRWFjaChmdW5jdGlvbiAodGlsZSkge1xyXG4gICAgICAgICh0aWxlIGFzIEhUTUxFbGVtZW50KS5kcmFnZ2FibGUgPSB0cnVlO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG52YXIgZGlzYWJsZURyYWdnaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnRpbGVcIikpLmZvckVhY2goZnVuY3Rpb24gKHRpbGUpIHtcclxuICAgICAgICAodGlsZSBhcyBIVE1MRWxlbWVudCkuZHJhZ2dhYmxlID0gZmFsc2U7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbnZhciBjcmVhdGVUaWxlcyA9IGZ1bmN0aW9uIChsZXR0ZXJzQXJyYXkpIHtcclxuICAgIHZhciB0aWxlc0FycmF5ID0gW107XHJcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGxldHRlcnNBcnJheSwgZnVuY3Rpb24gKGxldHRlciwgaW5kZXgpIHtcclxuICAgICAgICB0aWxlc0FycmF5LnB1c2goXCI8ZGl2IGNsYXNzPVxcXCJjZWxsXFxcIiBkYXRhLXJvdz1cXFwiMFxcXCIgZGF0YS1jb2x1bW49XFxcIlwiICsgaW5kZXggKyBcIlxcXCI+PHNwYW4gY2xhc3M9XFxcInRpbGVcXFwiIGRhdGEtdGlsZS1pZD1cXFwiXCIgKyBudW1iZXJPZlRpbGVzICsgXCJcXFwiIGRyYWdnYWJsZT1cXFwidHJ1ZVxcXCI+XCIgKyBsZXR0ZXIgKyBcIjwvc3Bhbj48L2Rpdj5cIik7XHJcbiAgICAgICAgbnVtYmVyT2ZUaWxlcyArPSAxO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGlsZXNBcnJheTtcclxufTtcclxuXHJcbnZhciBhZGRUaWxlTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBBcnJheS5mcm9tKEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi50aWxlXCIpKSkuZm9yRWFjaChmdW5jdGlvbiAodGlsZSkge1xyXG4gICAgICAgIHRpbGUuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdzdGFydFwiLCBoYW5kbGVEcmFnU3RhcnQsIG9wdGlvbnMpO1xyXG4gICAgICAgIHRpbGUuYWRkRXZlbnRMaXN0ZW5lcihcImRibGNsaWNrXCIsIGhhbmRsZURvdWJsZUNsaWNrKTtcclxuICAgICAgICB0aWxlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVDbGljaywgb3B0aW9ucyk7XHJcbiAgICAgICAgdGlsZS5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VuZFwiLCBoYW5kbGVEcmFnRW5kLCBvcHRpb25zKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gcmVuZGVyX2dhbWUocmVzcCwgcGxheWVyX2lkLCB0aWxlcykge1xyXG4gICAgY29uc29sZS5sb2cocmVzcCk7XHJcbiAgICB2YXIgY3VyX3RpbGVzID0gcmVzcFtcInBsYXllcnNcIl1bcGxheWVyX2lkXTtcclxuICAgIC8vIFJlbmRlciB0aGUgZ2FtZSBiYXNlZCBvbiB0aGUgdmFyaW91cyBnYW1lIHN0YXRlc1xyXG4gICAgLy8gV2FpdGluZyB0byBnaXZlIG91dCB0aWxlc1xyXG4gICAgaWYgKHJlc3BbXCJzdGF0ZVwiXSA9PSBcIklETEVcIikge1xyXG4gICAgICAgIGhpZGVCdXR0b25zKCk7XHJcbiAgICAgICAgJChcIiNqb2luX2dhbWVcIikuaGlkZSgpO1xyXG4gICAgICAgICQoXCIubG9iYnlcIikuc2hvdygpO1xyXG4gICAgICAgICQoXCIjb3B0aW9uc1wiKS5zaG93KCk7XHJcbiAgICAgICAgJChcIiNzdGFydF9nYW1lX2J1dHRvblwiKS5zaG93KCk7XHJcbiAgICB9IC8vIFRoZSBtYWluIGdhbXBsYXkgc3RhdGVcclxuICAgIGVsc2UgaWYgKHJlc3BbXCJzdGF0ZVwiXSA9PSBcIkFDVElWRVwiKSB7XHJcbiAgICAgICAgJChcIiNnYW1lcGxheVwiKS5zaG93KCk7XHJcbiAgICAgICAgJChcIi5sb2JieVwiKS5oaWRlKCk7XHJcbiAgICAgICAgaGlkZUJ1dHRvbnMoKTtcclxuICAgICAgICAkKFwiI29wdGlvbnNcIikuc2hvdygpO1xyXG4gICAgICAgICQoXCIjcGVlbF9idXR0b25cIikuc2hvdygpO1xyXG4gICAgICAgICQoXCIjc3dhcF9idXR0b25cIikuc2hvdygpO1xyXG4gICAgICAgICQoXCIjc2VsZWN0X2J1dHRvblwiKS5zaG93KCk7XHJcbiAgICAgICAgJChcIiN0aWxlc19yZW1haW5pbmdcIikuc2hvdygpO1xyXG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgY291bnRcclxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRpbGVzX3JlbWFpbmluZ19jb3VudFwiKS50ZXh0Q29udGVudCA9IHJlc3BbXCJ0aWxlc19yZW1haW5pbmdcIl07XHJcbiAgICAgICAgLy8gUmVuZGVyIG9ubHkgdGhlIG5ldyB0aWxlc1xyXG4gICAgICAgIHZhciBuZXdUaWxlcyA9IGZpbmREaWZmZXJlbmNlKGN1cl90aWxlcywgdGlsZXMpO1xyXG4gICAgICAgIHRpbGVzID0gY3VyX3RpbGVzO1xyXG4gICAgICAgIHBvcHVsYXRlKFwiYmVuY2hcIiwgY3JlYXRlVGlsZXMobmV3VGlsZXMpKTtcclxuICAgICAgICBhZGRUaWxlTGlzdGVuZXIoKTtcclxuICAgIH0gLy8gQ2FuIG5vIGxvbmdlciBwZWVsXHJcbiAgICBlbHNlIGlmIChyZXNwW1wic3RhdGVcIl0gPT0gXCJFTkRHQU1FXCIpIHtcclxuICAgICAgICBoaWRlQnV0dG9ucygpO1xyXG4gICAgICAgIGVuYWJsZURyYWdnaW5nKCk7XHJcbiAgICAgICAgJChcIiNnYW1lcGxheVwiKS5zaG93KCk7XHJcbiAgICAgICAgJChcIi5sb2JieVwiKS5oaWRlKCk7XHJcbiAgICAgICAgJChcIiNnYW1lLW92ZXJcIikuaGlkZSgpO1xyXG4gICAgICAgICQoXCIjb3B0aW9uc1wiKS5zaG93KCk7XHJcbiAgICAgICAgJChcIiNzd2FwX2J1dHRvblwiKS5zaG93KCk7XHJcbiAgICAgICAgJChcIiNiYW5hbmFncmFtc19idXR0b25cIikuc2hvdygpO1xyXG4gICAgICAgICQoXCIjc2VsZWN0X2J1dHRvblwiKS5zaG93KCk7XHJcbiAgICAgICAgLy8gUmVuZGVyIG9ubHkgdGhlIG5ldyB0aWxlc1xyXG4gICAgICAgIHZhciBuZXdUaWxlcyA9IGZpbmREaWZmZXJlbmNlKGN1cl90aWxlcywgdGlsZXMpO1xyXG4gICAgICAgIHRpbGVzID0gY3VyX3RpbGVzO1xyXG4gICAgICAgIHBvcHVsYXRlKFwiYmVuY2hcIiwgY3JlYXRlVGlsZXMobmV3VGlsZXMpKTtcclxuICAgICAgICBhZGRUaWxlTGlzdGVuZXIoKTtcclxuICAgIH0gLy8gR2FtZSBvdmVyXHJcbiAgICBlbHNlIGlmIChyZXNwW1wic3RhdGVcIl0gPT0gXCJPVkVSXCIpIHtcclxuICAgICAgICBoaWRlQnV0dG9ucygpO1xyXG4gICAgICAgIGRpc2FibGVEcmFnZ2luZygpO1xyXG4gICAgICAgICQoXCIjZ2FtZS1vdmVyXCIpLnNob3coKTtcclxuICAgICAgICAkKFwiI2dhbWVwbGF5XCIpLmhpZGUoKTtcclxuICAgICAgICAkKFwiLmxvYmJ5XCIpLmhpZGUoKTtcclxuICAgICAgICAkKFwiI29wdGlvbnNcIikuc2hvdygpO1xyXG4gICAgICAgICQoXCIjY29udGludWVfZ2FtZV9idXR0b25cIikuc2hvdygpO1xyXG4gICAgICAgIC8vIERpc3BsYXkgdGhlIHdpbm5pbmcgY29udGVudFxyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2lubmluZ19wbGF5ZXJcIikudGV4dENvbnRlbnQgPSByZXNwW1wid2lubmluZ19wbGF5ZXJcIl0gKyBcIiBoYXMgY2FsbGVkIEJhbmFuYWdyYW1zLiBWZXJpZnkgdGhlaXIgYm9hcmQgYW5kIGVpdGhlciBjb250aW51ZSB0aGUgZ2FtZSBvciBzdGFydCBhIG5ldyBvbmUhXCI7XHJcbiAgICAgICAgLy8gQ2hlY2sgZWFjaCB3aW5uaW5nIHdvcmQncyB2YWxpZGl0eSBhbmQgY29sb3IgYWNjb3JkaW5nbHlcclxuICAgICAgICB2YXIgd2lubmluZ1dvcmRzTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2lubmluZy13b3Jkc1wiKTtcclxuICAgICAgICB3aW5uaW5nV29yZHNMaXN0LmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICAgICAgcmVzcFtcIndpbm5pbmdfd29yZHNcIl0uZm9yRWFjaChmdW5jdGlvbiAod29yZF9wYWlyKSB7XHJcbiAgICAgICAgICAgIGlmICh3b3JkX3BhaXJbMV0pIHtcclxuICAgICAgICAgICAgICAgIHdpbm5pbmdXb3Jkc0xpc3QuaW5uZXJIVE1MICs9IFwiPHAgc3R5bGU9XFxcImNvbG9yOiBncmVlblxcXCI+XCIgKyB3b3JkX3BhaXJbMF0gKyBcIjwvcD5cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHdpbm5pbmdXb3Jkc0xpc3QuaW5uZXJIVE1MICs9IFwiPHAgc3R5bGU9XFxcImNvbG9yOiByZWRcXFwiPlwiICsgd29yZF9wYWlyWzBdICsgXCI8L3A+XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0gLy8gVW5rbm93biBzdGF0ZVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgc2hvd0Vycm9yKFwiQW4gZXJyb3Igb2NjdXJyZWQ6IFVua25vd24gY2xpZW50IHN0YXRlLlwiKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGlsZXM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dFcnJvcihtc2cpIHtcclxuICAgICQoXCIjZXJyb3JcIikuaHRtbChtc2cpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoaWRlQnV0dG9ucygpIHtcclxuICAgICQoXCIjc3RhcnRfZ2FtZV9idXR0b25cIikuaGlkZSgpO1xyXG4gICAgJChcIiNzcGxpdF9idXR0b25cIikuaGlkZSgpO1xyXG4gICAgJChcIiNwZWVsX2J1dHRvblwiKS5oaWRlKCk7XHJcbiAgICAkKFwiI3N3YXBfYnV0dG9uXCIpLmhpZGUoKTtcclxuICAgICQoXCIjc2VsZWN0X2J1dHRvblwiKS5oaWRlKCk7XHJcbiAgICAkKFwiI2JhbmFuYWdyYW1zX2J1dHRvblwiKS5oaWRlKCk7XHJcbiAgICAkKFwiI2NvbnRpbnVlX2dhbWVfYnV0dG9uXCIpLmhpZGUoKTtcclxuICAgICQoXCIjdGlsZXNfcmVtYWluaW5nXCIpLmhpZGUoKTtcclxufVxyXG5cclxudmFyIHBvcHVsYXRlID0gZnVuY3Rpb24gKHBhcmVudGlkLCBjaGlsZHJlbkFycmF5KSB7XHJcbiAgICB2YXIgcGFyZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocGFyZW50aWQpO1xyXG4gICAgY2hpbGRyZW5BcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xyXG4gICAgICAgIHBhcmVudC5pbm5lckhUTUwgKz0gY2hpbGQ7XHJcbiAgICB9KTtcclxufTtcclxuXHJcblxyXG5leHBvcnQgeyBzaG93RXJyb3IsIHJlbmRlcl9nYW1lIH07IiwiLyoqXHJcbiAqIFNvY2tldCBmdW5jdGlvbnMgdGhhdCBtYWtlIGNhbGxzIHRvIHRoZSBiYWNrZW5kIGFuZCBjYWxsIHRoZSByZW5kZXIgZnVuY3Rpb24gYmFzZWQgb24gdGhlIHJlc3BvbnNlLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IGNsZWFuQmVuY2ggfSBmcm9tICcuL2V2ZW50cyc7XHJcbmltcG9ydCB7IGdldEFsbFdvcmRzLCBpc1ZhbGlkQm9hcmQgfSBmcm9tIFwiLi9oZWxwZXJzXCI7XHJcbmltcG9ydCB7IHJlbmRlcl9nYW1lLCBzaG93RXJyb3IgfSBmcm9tIFwiLi9yZW5kZXJcIjtcclxuXHJcbnZhciBzb2NrZXRfc3RhdGUgPSB7XHJcbiAgICBcInBsYXllcl9pZFwiOiBudWxsLFxyXG4gICAgXCJnYW1lX3N0YXRlXCI6IG51bGwsXHJcbiAgICBcImRldlwiOiBmYWxzZSxcclxufTtcclxuXHJcbmxldCB0aWxlcyA9IFtdO1xyXG5sZXQgcGxheWVycyA9IG51bGw7XHJcbmNvbnN0IGhyZWZfcGFydHMgPSB3aW5kb3cubG9jYXRpb24uaHJlZi5zcGxpdChcIi9cIik7XHJcbmNvbnN0IGdhbWVfbmFtZSA9IGhyZWZfcGFydHNbaHJlZl9wYXJ0cy5sZW5ndGggLSAxXTtcclxuY29uc3QgbWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVudVwiKTtcclxuXHJcbi8vIFdoZXRoZXIgdGhlIGN1cnJlbnQgY2xpZW50IGhhcyBhbHJlYWR5IGpvaW5lZCB0aGUgZ2FtZVxyXG5sZXQgaGFzSm9pbmVkID0gZmFsc2U7XHJcblxyXG4vLyBAdHMtaWdub3JlXHJcbmNvbnN0IHNvY2tldCA9IGlvKCk7XHJcblxyXG4vLyBKb2luIHRoZSBuZWNlc3Nhcnkgcm9vbVxyXG5zb2NrZXQub24oXCJjb25uZWN0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgIHNvY2tldC5lbWl0KFwiam9pblwiLCB7XHJcbiAgICAgICAgXCJuYW1lXCI6IGdhbWVfbmFtZVxyXG4gICAgfSk7XHJcbiAgICBsb2FkX2dhbWUoKTtcclxufSk7XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBSZW5kZXIgZ2FtZSBhY3Rpb25cclxuc29ja2V0Lm9uKFwicmVuZGVyX2dhbWVcIiwgZnVuY3Rpb24gKHJlc3ApIHtcclxuICAgIGlmICghcmVzcC5oYXNPd25Qcm9wZXJ0eShcInN0YXR1c19jb2RlXCIpKSB7XHJcbiAgICAgICAgc2hvd0Vycm9yKFwiRGlkIG5vdCByZWNpZXZlIGEgcmVzcG9uc2UgZnJvbSB0aGUgc2VydmVyLlwiKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGlmIChyZXNwW1wic3RhdHVzX2NvZGVcIl0gPT0gMjAwKSB7XHJcbiAgICAgICAgICAgIHNvY2tldF9zdGF0ZS5nYW1lX3N0YXRlID0gSlNPTi5wYXJzZShyZXNwLnBheWxvYWQpO1xyXG4gICAgICAgICAgICAvLyBEbyBub3QgcmVuZGVyIHRoZSBnYW1lIGlmIHRoZSBjbGllbnQgaGFzIG5vdCBqb2luZWQgdGhlIGdhbWVcclxuICAgICAgICAgICAgcGxheWVycyA9IHNvY2tldF9zdGF0ZS5nYW1lX3N0YXRlW1wicGxheWVyc1wiXTtcclxuICAgICAgICAgICAgdmFyIHBsYXllcl9saXN0XzEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllcnNcIik7XHJcbiAgICAgICAgICAgIHBsYXllcl9saXN0XzEuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMocGxheWVycykuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJfbGlzdF8xLmlubmVySFRNTCArPSBcIjxsaT5cIiArIHBsYXllclswXSArIFwiPC9saT5cIjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICghaGFzSm9pbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aWxlcyA9IHJlbmRlcl9nYW1lKHNvY2tldF9zdGF0ZS5nYW1lX3N0YXRlLHNvY2tldF9zdGF0ZS5wbGF5ZXJfaWQsIHRpbGVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKCFyZXNwLmhhc093blByb3BlcnR5KFwibWVzc2FnZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgc2hvd0Vycm9yKFwiQW4gZXJyb3Igb2NjdXJyZWQsIGJ1dCBubyBtZXNzYWdlIHdhcyBnaXZlbi5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzaG93RXJyb3IoXCJBbiBlcnJvciBvY2N1cnJlZDogXCIgKyByZXNwW1wibWVzc2FnZVwiXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gbG9hZF9nYW1lKCkge1xyXG4gICAgc29ja2V0LmVtaXQoXCJsb2FkX2dhbWVcIiwge1xyXG4gICAgICAgIFwibmFtZVwiOiBnYW1lX25hbWVcclxuICAgIH0pO1xyXG59XHJcbi8vIEpvaW4gdGhlIGdhbWVcclxuZnVuY3Rpb24gcGxheWVyX2pvaW4oKSB7XHJcbiAgICBzb2NrZXRfc3RhdGUucGxheWVyX2lkID0gKDxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyX2lkXCIpKS52YWx1ZTtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicGxheWVyX2lkXCIsIHNvY2tldF9zdGF0ZS5wbGF5ZXJfaWQpO1xyXG4gICAgc29ja2V0LmVtaXQoXCJwbGF5ZXJfam9pblwiLCB7XHJcbiAgICAgICAgXCJuYW1lXCI6IGdhbWVfbmFtZSxcclxuICAgICAgICBcInBsYXllcl9pZFwiOiBzb2NrZXRfc3RhdGUucGxheWVyX2lkXHJcbiAgICB9KTtcclxuICAgIGhhc0pvaW5lZCA9IHRydWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRldl9qb2luKCkge1xyXG4gICAgc29ja2V0X3N0YXRlLnBsYXllcl9pZCA9IFwiZGV2X3AxXCJcclxuICAgIHNvY2tldF9zdGF0ZS5kZXYgPSB0cnVlO1xyXG4gICAgaGFzSm9pbmVkID0gdHJ1ZTtcclxuICAgIGxvYWRfZ2FtZSgpO1xyXG59XHJcblxyXG4vLyBTdGFydCB0aGUgZ2FtZVxyXG5mdW5jdGlvbiBzdGFydF9nYW1lKCkge1xyXG4gICAgc29ja2V0LmVtaXQoXCJzdGFydF9nYW1lXCIsIHtcclxuICAgICAgICBcIm5hbWVcIjogZ2FtZV9uYW1lLFxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIFBlcmZvcm0gdGhlIHNwbGl0IGFjdGlvblxyXG5mdW5jdGlvbiBzcGxpdCgpIHtcclxuICAgIHNvY2tldC5lbWl0KFwic3BsaXRcIiwge1xyXG4gICAgICAgIFwibmFtZVwiOiBnYW1lX25hbWUsXHJcbiAgICB9KTtcclxufVxyXG5cclxuLy8gUGVyZm9ybSB0aGUgcGVlbCBhY3Rpb25cclxuZnVuY3Rpb24gcGVlbCgpIHtcclxuICAgIC8vIE1ha2Ugc3VyZSB0aGUgYm9hcmQgaXMgdmFsaWRcclxuICAgIGlmICghc29ja2V0X3N0YXRlLmRldiAmJiAhaXNWYWxpZEJvYXJkKCkpIHtcclxuICAgICAgICBhbGVydChcIllvdXIgYmVuY2ggbXVzdCBiZSBlbXB0eSBhbmQgeW91ciBib2FyZCBtdXN0IGJlIHZhbGlkLlwiKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBzb2NrZXQuZW1pdChcInBlZWxcIiwge1xyXG4gICAgICAgIFwibmFtZVwiOiBnYW1lX25hbWUsXHJcbiAgICB9KTtcclxufVxyXG5cclxuLy8gUGVyZm9ybSBhIHN3YXBcclxuZnVuY3Rpb24gc3dhcCgpIHtcclxuICAgIGlmIChzb2NrZXRfc3RhdGUuZ2FtZV9zdGF0ZVtcInRpbGVzX3JlbWFpbmluZ1wiXSA8IDMpIHtcclxuICAgICAgICBhbGVydChcIkxlc3MgdGhhdCAzIHRpbGVzIHJlbWFpbmluZywgY2Fubm90IHN3YXAuXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgYWN0aXZlX3RpbGVfaWQgPSBtZW51LmdldEF0dHJpYnV0ZShcImFjdGl2ZS10aWxlLWlkXCIpO1xyXG4gICAgdmFyIHRpbGVUb1JlbW92ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGlsZVtkYXRhLXRpbGUtaWQ9XFxcIlwiICsgYWN0aXZlX3RpbGVfaWQgKyBcIlxcXCJdXCIpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB2YXIgbGV0dGVyID0gdGlsZVRvUmVtb3ZlLnRleHRDb250ZW50O1xyXG4gICAgfSBjYXRjaCAoVHlwZUVycm9yKSB7XHJcbiAgICAgICAgYWxlcnQoXCJObyB0aWxlIHNlbGVjdGVkIGZvciBzd2FwcGluZywgZG91YmxlIGNsaWNrIGEgdGlsZSB0byBzZWxlY3QhXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRpbGVUb1JlbW92ZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRpbGVUb1JlbW92ZSk7XHJcbiAgICAvLyBBbHNvIHJlbW92ZSBlbGVtZW50IGZyb20gdGhlIGdsb2JhbCB0aWxlcyBhcnJheVxyXG4gICAgdmFyIGluZGV4ID0gdGlsZXMuaW5kZXhPZihsZXR0ZXIpO1xyXG4gICAgaWYgKGluZGV4ICE9PSAtMSlcclxuICAgICAgICB0aWxlcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgc29ja2V0LmVtaXQoXCJzd2FwXCIsIHtcclxuICAgICAgICBcIm5hbWVcIjogZ2FtZV9uYW1lLFxyXG4gICAgICAgIFwibGV0dGVyXCI6IGxldHRlcixcclxuICAgICAgICBcInBsYXllcl9pZFwiOiBzb2NrZXRfc3RhdGUucGxheWVyX2lkXHJcbiAgICB9KTtcclxuICAgIGNsZWFuQmVuY2goKTtcclxufVxyXG5cclxuLy8gQmFuYW5hZ3JhbXNcclxuZnVuY3Rpb24gYmFuYW5hZ3JhbXMoKSB7XHJcbiAgICAvLyBNYWtlIHN1cmUgdGhlIGJvYXJkIGlzIHZhbGlkXHJcbiAgICBpZiAoIXNvY2tldF9zdGF0ZS5kZXYgJiYgIWlzVmFsaWRCb2FyZCgpKSB7XHJcbiAgICAgICAgYWxlcnQoXCJZb3VyIGJlbmNoIG11c3QgYmUgZW1wdHkgYW5kIHlvdXIgYm9hcmQgbXVzdCBiZSB2YWxpZC5cIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdmFyIHdvcmRzID0gZ2V0QWxsV29yZHMoKTtcclxuICAgIHNvY2tldC5lbWl0KFwiYmFuYW5hZ3JhbXNcIiwge1xyXG4gICAgICAgIFwibmFtZVwiOiBnYW1lX25hbWUsXHJcbiAgICAgICAgXCJwbGF5ZXJfaWRcIjogc29ja2V0X3N0YXRlLnBsYXllcl9pZCxcclxuICAgICAgICBcIndvcmRzXCI6IHdvcmRzXHJcbiAgICB9KTtcclxufVxyXG5cclxuLy8gQ29udGludWUgdGhlIGdhbWVcclxuZnVuY3Rpb24gY29udGludWVfZ2FtZSgpIHtcclxuICAgIHNvY2tldC5lbWl0KFwiY29udGludWVfZ2FtZVwiLCB7XHJcbiAgICAgICAgXCJuYW1lXCI6IGdhbWVfbmFtZSxcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBSZXNldCB0aGUgZ2FtZVxyXG5mdW5jdGlvbiByZXNldCgpIHtcclxuICAgIEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi50aWxlXCIpKS5mb3JFYWNoKGZ1bmN0aW9uICh0aWxlKSB7XHJcbiAgICAgICAgdGlsZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRpbGUpO1xyXG4gICAgfSk7XHJcbiAgICBjbGVhbkJlbmNoKCk7XHJcbiAgICB0aWxlcyA9IFtdO1xyXG4gICAgc29ja2V0LmVtaXQoXCJyZXNldFwiLCB7XHJcbiAgICAgICAgXCJuYW1lXCI6IGdhbWVfbmFtZVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgICBkZXZfam9pbixcclxuICAgIHBsYXllcl9qb2luLFxyXG4gICAgbG9hZF9nYW1lLFxyXG4gICAgc3RhcnRfZ2FtZSxcclxuICAgIHNwbGl0LFxyXG4gICAgcGVlbCxcclxuICAgIHJlc2V0LFxyXG4gICAgYmFuYW5hZ3JhbXMsXHJcbiAgICBjb250aW51ZV9nYW1lLFxyXG4gICAgc3dhcCxcclxuICAgIHNvY2tldF9zdGF0ZSxcclxufSJdLCJzb3VyY2VSb290IjoiIn0=